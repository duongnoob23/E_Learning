

____________________________L·ªói Crash do l∆∞u data trong error Redux___________________


B·∫°n d√πng Redux Toolkit + createAsyncThunk + unwrap cho login.
Khi login sai (v√≠ d·ª• email kh√¥ng t·ªìn t·∫°i) ‚Üí thunk tr·∫£ v·ªÅ rejectWithValue({EM, EC, DT}).
Trong Login.jsx, b·∫°n c√≥ state error v√† trong JSX l·∫°i c√≥ ƒëo·∫°n render ki·ªÉu:
{authError && <div className="auth-page__error">{authError}</div>}
Nh∆∞ng authError l√∫c n√†y kh√¥ng ph·∫£i l√† string, m√† l√† object {EM, EC, DT}.
üëâ React kh√¥ng cho render object tr·ª±c ti·∫øp ‚Üí n√≥ crash v·ªõi l·ªói:
Uncaught Error: Objects are not valid as a React child (found: object with keys {EM, EC, DT})
2Ô∏è‚É£ Bi·ªÉu hi·ªán
App crash to√†n b·ªô UI, k√®m theo g·ª£i √Ω c·ªßa React: d√πng Error Boundary ho·∫∑c ki·ªÉm tra ch·ªó render.
Console log th√¨ th·∫•y error ho·∫∑c authError in ra l√† object ch·ª© kh√¥ng ph·∫£i string.
3Ô∏è‚É£ C√°ch suy lu·∫≠n
Nh√¨n v√†o rejectWithValue trong thunk ‚Üí n√≥ lu√¥n return object {EM, EC, DT}.
V·ªõi .unwrap() th√¨ catch nh·∫≠n ƒë√∫ng object n√†y, kh√¥ng ph·∫£i exception thu·∫ßn.
Trong UI, b·∫°n render authError tr·ª±c ti·∫øp ‚Üí React c·ªë convert object th√†nh string ‚Üí crash.
üëâ K·∫øt lu·∫≠n: giao di·ªán mu·ªën string nh∆∞ng b·∫°n truy·ªÅn object.
4Ô∏è‚É£ C√°ch fix
C√≥ 2 h∆∞·ªõng, tu·ª≥ b·∫°n mu·ªën state authError l∆∞u g√¨:
üîπ H∆∞·ªõng 1: L∆∞u object trong Redux
authError trong slice gi·ªØ nguy√™n {EM, EC, DT}.
Trong UI ch·ªâ hi·ªÉn th·ªã message:
{authError && <div className="auth-page__error">{authError.EM}</div>}
üîπ H∆∞·ªõng 2: L∆∞u string trong Redux
Trong slice, khi b·ªã reject th√¨ ch·ªâ l∆∞u error = action.payload?.EM || "C√≥ l·ªói x·∫£y ra".
Trong UI render b√¨nh th∆∞·ªùng:
{authError && <div className="auth-page__error">{authError}</div>}
5Ô∏è‚É£ Vai tr√≤ unwrap & rejectWithValue
rejectWithValue: cho ph√©p b·∫°n ch·ªß ƒë·ªông b·∫Øn l·ªói c√≥ shape chu·∫©n {EM, EC, DT} thay v√¨ Error object m·∫∑c ƒë·ªãnh.
.unwrap(): gi√∫p await dispatch(thunk) throw lu√¥n reject payload ‚Üí b·∫°n x·ª≠ l√Ω trong try/catch d·ªÖ h∆°n.
N·∫øu kh√¥ng unwrap ‚Üí dispatch(thunk) ch·ªâ tr·∫£ v·ªÅ action (fulfilled/rejected) ‚Üí b·∫°n ph·∫£i check th·ªß c√¥ng trong extraReducers.
‚úÖ T√≥m g·ªçn
Nguy√™n nh√¢n: b·∫°n render object thay v√¨ string trong JSX.
Bi·ªÉu hi·ªán: React crash v·ªõi l·ªói "Objects are not valid as a React child".
Fix: ho·∫∑c ch·ªâ render authError.EM, ho·∫∑c ch·ªâ l∆∞u string v√†o authError.
Best practice: th·ªëng nh·∫•t 1 ki·ªÉu (ho·∫∑c object, ho·∫∑c string) trong slice ƒë·ªÉ UI d·ªÖ x·ª≠ l√Ω.





____________________________L·ªói ___________________